---
name: article-parser
description: 从多个平台提取和整理文章内容到本地文档系统。核心策略：遇到小红书/抖音等图片/视频平台链接时，优先搜索同作者/同标题的微信公众号版本。如无微信公众号版本，再使用原平台提取流程。使用时机：用户提供任何平台文章链接、要求提取文章内容或"解析XX文章"时。
---

# 文章解析与归档

## 核心工作流程

### 优先搜索策略

**情况 1：用户提供小红书/抖音/图片视频平台链接**

1. 识别作者/标题
2. 搜索微信公众号（同作者 + 同标题）
3. 找到 → 使用微信公众号版本 | 未找到 → 使用原平台提取

**情况 1.5：视频+文章双来源**

短视频无法提供详细内容时，保留视频为主，搜索相关文字报道作为补充参考。

关键原则：
- 正文内容完全基于补充参考（文章）
- 不虚构"基于视频理解"的内容
- 两个来源都在开头引用处标注

详细流程：见 [双来源处理](references/dual-source.md)

**情况 2：用户直接提供微信公众号/博客链接**

直接提取（文字平台最优）

---

## 平台优先级

| 优先级 | 平台 | 内容格式 | 推荐度 |
|-------|------|----------|--------|
| 🥇 1 | 微信公众号 | 纯文本/HTML | ✅✅✅ |
| 🥈 2 | 个人博客/官网 | 纯文本/HTML | ✅✅ |
| 🥉 3 | Medium/Dev.to | 纯文本/HTML | ✅✅ |
| 4 | 知乎/简书 | 纯文本/HTML | ✅ |
| 5 | 小红书 | 图片 | ⚠️ |
| 6 | 抖音/B站 | 视频 | ⚠️ |

**原则**：优先使用文字友好的平台，同一内容优先选择文字版本。

---

## 快速参考

### 微信公众号提取

**流程**：滚动触发懒加载 → 提取图片 → 过滤SVG → 下载 → 验证

**关键要点**：
- 必须滚动到页面底部触发所有懒加载
- 过滤掉 `data:image/svg` 占位符，只保留 `mmbiz.qpic.cn` 真实图片
- 按照 `imgIndex` 参数顺序确定图片位置
- 不要通过分析图片内容推断位置（会出错）

详细最佳实践：见 [微信最佳实践](references/wechat-best-practices.md)

### 小红书提取

**图文笔记**：获取图片URL → 缓存URL → OCR识别 → 整理内容

**视频笔记**：获取视频URL → 缓存URL → 提取文本信息 → 整理内容

**关键要点**：
- 核心内容在图片中，必须完整提取
- 使用缓存机制避免重复提取
- 去除转发者评论，保留原作者内容

详细流程：见 [小红书提取](references/xiaohongshu-workflow.md)

### 内容整理原则

**忠于原文**：
- ✅ 逐句翻译，保持原文表述方式
- ✅ 保留所有代码示例、技术细节
- ❌ 不要删除、概括、改写正文

**删除非核心内容**：
- ❌ "关于作者"部分（个人简介、职位）
- ❌ "关注我"、"点赞"等引导语
- ❌ 公众号二维码、推广信息

详细原则：见 [内容整理](references/content-organization.md)

### 验证环节

**检查项**：
- 基础信息（标题、来源、链接）
- 章节完整性（编号连续、无截断）
- 图片完整性（引用数量=文件数量）
- 格式验证（代码块闭合、标题层级）

详细清单：见 [验证环节](references/validation.md)

### 文件归档

**必须创建三个文件**：
```
general/article-slug/
├── article-slug.md              # 正文（本地版本）- 必须
├── article-slug-remote.md        # 正文（远程版本）- 必须
├── article-slug.metadata.yaml    # 元数据 - 必须
└── images/                       # 图片目录 - 必须
```

**双版本策略**（必须同时创建）：
- **本地版本**：图片使用 `./images/xxx.jpg`（本地预览）
- **远程版本**：图片使用原始 CDN URL（分享、发布）

**重要**：remote 版本不是可选的，必须创建！用于在线分享和发布。

详细说明：见 [文件归档](references/file-archiving.md)

---

## 搜索技巧

### 搜索策略

**多级搜索流程**（按优先级）：

1. **搜狗微信搜索** - 搜索微信公众号版本
   - 访问：https://weixin.sogou.com/
   - 搜索：`<公众号名称> <文章关键词>`
   - 检查：公众号名称、标题关键词、发布时间
   - ✅ 找到 → 访问并提取内容（文字平台最优）
   - ❌ 未找到 → 继续第2步

2. **Google/Bing 全网搜索** - 搜索其他平台版本
   - Google: `<作者名称> "<文章标题/关键词>"`
   - Bing: `<作者名称> "<文章标题/关键词>"`
   - 目标平台：个人博客、Medium、Dev.to、知乎等
   - ✅ 找到 → 访问并提取内容（文字平台优先）
   - ❌ 未找到 → 继续第3步

3. **原平台提取** - 回到用户提供的原始链接
   - 小红书：图片 OCR 识别
   - 抖音/B站：视频内容提取
   - 适用场景：全网无文字版本时

---

## Scripts

### cache_image_urls.sh

图片/视频 URL 缓存管理脚本，避免重复提取。

**用法**：
```bash
./cache_image_urls.sh <文章URL> get           # 获取缓存
./cache_image_urls.sh <文章URL> save <URLS>   # 保存URL
```

---

## 资源和示例

### References（详细文档）

- [微信最佳实践](references/wechat-best-practices.md) - 图片提取、懒加载处理、位置确定
- [小红书提取](references/xiaohongshu-workflow.md) - 图文/视频笔记提取流程
- [双来源处理](references/dual-source.md) - 视频+文章双来源处理
- [验证环节](references/validation.md) - 完整性验证检查清单
- [内容整理](references/content-organization.md) - 忠于原文原则
- [文件归档](references/file-archiving.md) - 双版本策略、Git 策略
- [图片位置确定](references/image-position-determination.md) - 微信图片位置最佳实践

### 示例

- **图文笔记**：`general/claude-code-31-tips/` - Claude Code 使用技巧
- **视频笔记**：`general/manus-claude-best-agent-model/` - Manus 演讲（双来源）

参考这些示例了解内容组织和格式规范。
