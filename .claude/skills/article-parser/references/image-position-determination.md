**微信公众号图片位置确定的最佳实践（2026-01-20 更新）**：

根据实战经验（Browser Use Agent SDK 文章提取），总结了以下关键教训：

**❌ 错误方法（浪费时间和精力）**：
1. 通过视觉分析（OCR）理解图片内容
2. 根据图片内容推断它应该在哪个章节
3. 对比图片尺寸、格式来推测顺序
4. 使用 AI 图像理解工具分析图片

**✅ 正确方法（高效且准确）**：
1. 使用 JavaScript 提取所有图片的 `imgIndex` 参数
2. 按照 `imgIndex=0, 1, 2, 3...` 的顺序下载图片
3. 使用 `take_snapshot` 查看网页结构，找到每张图片前后的文本
4. 按照文本位置确定图片应该插入的章节

**示例对比**：

| 方法 | 步骤 | 耗时 | 准确率 | 推荐 |
|------|------|------|--------|------|
| ❌ 图片内容分析 | 1. OCR 分析每张图片<br>2. 理解图片内容<br>3. 推断章节对应关系 | 长 | ~70% | ❌ 不推荐 |
| ✅ 网页结构分析 | 1. 提取 imgIndex<br>2. 查看网页快照<br>3. 按文本位置确定 | 短 | ~100% | ✅ 强烈推荐 |

**实际案例**：

Browser Use Agent SDK 文章提取过程中：
- **错误做法**：通过分析图片内容，误将 image_2.png（99% model 图）放在"逆向思维"部分
- **正确做法**：查看网页快照，发现 imgIndex=1 的图片出现在"The Bitter Lesson"之后
- **结果**：按照网页结构调整图片位置，无需分析图片内容

**核心原则**：
> **在微信公众号这种富文本文章中，图片的位置由它们在文章中出现的顺序决定，而不是由图片内容决定。**

**工作流程（推荐）**：

```bash
# 1. 提取图片 URL 和 imgIndex
js: getImagesWithIndex()

# 2. 按照 imgIndex 下载图片
curl -H "Referer: https://mp.weixin.qq.com/" \
  "url_with_imgIndex=0" -o image_0.png
curl -H "Referer: https://mp.weixin.qq.com/" \
  "url_with_imgIndex=1" -o image_1.png
# ...

# 3. 查看网页快照，确定图片位置
take_snapshot → 找到每张图片前后的文本

# 4. 在 Markdown 中按正确位置引用
# 不要通过分析图片内容来推断位置！
```

**完整提取流程（推荐）**：

```javascript
// 步骤1：滚动页面触发懒加载
